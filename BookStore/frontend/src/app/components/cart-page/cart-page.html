<div class="pt-25">
  <main class="flex flex-col md:flex-row p-5 md:p-10 max-w-7xl mx-auto">
    <div class="w-full md:w-1/4 mb-5 md:mb-0 md:mr-10 relative">
      <div class="hidden md:block relative top-[10px]">
        <img src="/images/bookmark.png" alt="Special Discounts" class="rounded-md shadow-lg" />
      </div>
    </div>

    <div class="flex-grow">
      <h1 class="text-2xl md:text-3xl font-bold text-center mb-8 text-gray-800">
        Your Cart Details
      </h1>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        @for (book of cartItems(); track book.title) {
        <div
          class="flex flex-col items-center border border-gray-300 p-4 md:p-6 rounded-lg shadow-sm"
        >
          <img
            [src]="book.imageUrl"
            [alt]="book.title"
            class="w-24 h-auto md:w-32 md:h-auto mb-4"
          />
          <div class="flex-grow text-center">
            <h3 class="text-xl font-semibold text-gray-900 mb-1">{{ book.title }}</h3>
            <p class="text-gray-600 mb-2">{{ book.author }}</p>
            <p class="text-2xl font-bold text-orange-500 mb-4">Rs. {{ book.price }}/=</p>
            <div class="flex items-center justify-center space-x-2">
              <span class="text-gray-700">Copies</span>
              <input
                type="number"
                [ngModel]="book.quantity"
                (ngModelChange)="updateQuantity(book, $event)"
                min="0"
                class="w-16 text-center border border-gray-300 rounded-md p-1 focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
              <button (click)="removeBookFromCart(book)" class="text-2xl hover:text-[var(--primary-color)] cursor-pointer"><i class="fa-solid fa-trash"></i></button>
            </div>
          </div>
        </div>
        }
      </div>

      <div class="text-center mt-8">
        <p class="text-xl md:text-2xl font-bold mb-4">
          Total Price: <span class="text-orange-500">Rs. {{ totalPrice() }}</span>
        </p>
        <button
          class="bg-white text-black font-semibold py-3 px-8 rounded-sm hover:bg-yellow-500 hover:border-none border border-solid border-black"
          (click)="openCheckoutModal()"
        >
          Proceed to Checkout
        </button>
      </div>
    </div>
  </main>

  @if (showCheckoutModal()) {
  <div class="fixed inset-0 bg-gray-900/75 flex justify-center items-center z-50 p-4">
    <div class="bg-black p-8 rounded-lg shadow-xl w-11/12 md:w-3/4 lg:w-2/3 xl:w-1/2">
      <h2 class="text-3xl font-bold text-yellow-600 mb-8 text-center">Checkout Details</h2>

      @if (notification()) { @if (notification()?.type === 'success') {
      <div role="status" class="mb-4 p-4 rounded-md bg-green-600 text-white text-center">
        {{ notification()?.text }}
      </div>
      } @if (notification()?.type === 'error') {
      <div role="alert" class="mb-4 p-4 rounded-md bg-red-600 text-white text-center">
        {{ notification()?.text }}
      </div>
      } }

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <div class="relative">
          <input
            type="text"
            id="receiverName"
            name="receiverName"
            [ngModel]="checkoutDetails().receiverName"
            (ngModelChange)="onInputChange('receiverName', $event)"
            class="w-full pl-12 pr-4 py-3 rounded-lg bg-gray-600 text-gray-100 placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-500"
            placeholder="Receiver name"
          />
          <div class="absolute inset-y-0 left-0 flex items-center pl-3">
            <svg
              class="h-6 w-6 text-gray-300"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
              />
            </svg>
          </div>
        </div>

        <div class="relative">
          <input
            type="text"
            id="billingAddress"
            name="billingAddress"
            [ngModel]="checkoutDetails().billingAddress"
            (ngModelChange)="onInputChange('billingAddress', $event)"
            class="w-full pl-12 pr-4 py-3 rounded-lg bg-gray-600 text-gray-100 placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-500"
            placeholder="Billing Address"
          />
          <div class="absolute inset-y-0 left-0 flex items-center pl-3">
            <svg
              class="h-6 w-6 text-gray-300"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
              />
            </svg>
          </div>
        </div>

        <div class="relative">
          <input
            type="text"
            id="sendingAddress"
            name="sendingAddress"
            [ngModel]="checkoutDetails().sendingAddress"
            (ngModelChange)="onInputChange('sendingAddress', $event)"
            class="w-full pl-12 pr-4 py-3 rounded-lg bg-gray-600 text-gray-100 placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-500"
            placeholder="Sending Address"
          />
          <div class="absolute inset-y-0 left-0 flex items-center pl-3">
            <svg
              class="h-6 w-6 text-gray-300"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
              />
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
              />
            </svg>
          </div>
        </div>

        <div class="relative">
          <select
            id="selectProvince"
            name="selectProvince"
            [ngModel]="checkoutDetails().province"
            (ngModelChange)="onInputChange('province', $event)"
            class="w-full pl-12 pr-4 py-3 rounded-lg bg-gray-600 text-gray-100 placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-500 appearance-none"
          >
            <option value="" disabled selected>Select Province</option>
            <option value="western">Western</option>
            <option value="central">Central</option>
          </select>
          <div class="absolute inset-y-0 left-0 flex items-center pl-3">
            <svg
              class="h-6 w-6 text-gray-300"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
              />
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
              />
            </svg>
          </div>
          <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
            <svg
              class="h-4 w-4 text-gray-300"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7"
              />
            </svg>
          </div>
        </div>

        <div class="relative">
          <input
            type="tel"
            id="contactNumber"
            name="contactNumber"
            [ngModel]="checkoutDetails().contactNumber"
            (ngModelChange)="onInputChange('contactNumber', $event)"
            class="w-full pl-12 pr-4 py-3 rounded-lg bg-gray-600 text-gray-100 placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-500"
            placeholder="Contact Number"
          />
          <div class="absolute inset-y-0 left-0 flex items-center pl-3">
            <svg
              class="h-6 w-6 text-gray-300"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
              />
            </svg>
          </div>
        </div>

        <div class="relative">
          <input
            type="text"
            id="cardNumber"
            name="cardNumber"
            [ngModel]="checkoutDetails().cardNumber"
            (ngModelChange)="onInputChange('cardNumber', $event)"
            class="w-full pl-12 pr-4 py-3 rounded-lg bg-gray-600 text-gray-100 placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-500"
            placeholder="Card Number"
          />
          <div class="absolute inset-y-0 left-0 flex items-center pl-3">
            <svg
              class="h-6 w-6 text-gray-300"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"
              />
            </svg>
          </div>
        </div>
      </div>

      <div class="flex flex-col md:flex-row justify-center space-y-4 md:space-y-0 md:space-x-6">
        <button
          class="bg-yellow-600 text-black font-bold py-3 px-10 rounded-full shadow-lg hover:bg-yellow-700 transition-colors duration-300 focus:outline-none"
          (click)="payNow()"
        >
          Pay Now
        </button>
        <button
          class="bg-transparent border-2 border-yellow-600 text-yellow-600 font-bold py-3 px-10 rounded-full shadow-lg hover:bg-yellow-600 hover:text-black transition-colors duration-300 focus:outline-none"
          (click)="closeCheckoutModal()"
        >
          Close Checkout Page
        </button>
      </div>

      <p class="text-red-500 text-sm mt-6 text-center">*Contact us to cancel your order</p>
    </div>
  </div>
  }
</div>
